(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-84551ca0"],{"12ae":function(t,e,a){"use strict";var o=a("7328"),r=a.n(o);r.a},"438f":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrap"},[a("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:t.newUser}},[t._v("\n    新增后台用户\n  ")]),t._v(" "),a("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{align:"center",label:"用户名",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.username))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"姓名",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"介绍",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.introduction))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"角色",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.roles))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"头像",width:"180"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("img",{attrs:{src:t.row.avatar,width:"50",alt:""}})]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.handleEdit(e.$index,e.row)}}},[t._v("编辑")]),t._v(" "),"admin"!==e.row.username?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.handleDelete(e.$index,e.row)}}},[t._v("删除")]):t._e()]}}])})],1),t._v(" "),a("el-dialog",{attrs:{title:t.isEdit?"编辑":"新增后台用户",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"form",attrs:{model:t.form}},[a("el-form-item",{attrs:{label:"登录名","label-width":t.formLabelWidth,prop:"username"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"密码","label-width":t.formLabelWidth,prop:"password"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"姓名","label-width":t.formLabelWidth,prop:"name"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"如：张三"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"介绍","label-width":t.formLabelWidth,prop:"introduction"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"如：运营管理"},model:{value:t.form.introduction,callback:function(e){t.$set(t.form,"introduction",e)},expression:"form.introduction"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"角色","label-width":t.formLabelWidth,prop:"role"}},[a("el-select",{attrs:{placeholder:"请选择角色"},model:{value:t.form.role,callback:function(e){t.$set(t.form,"role",e)},expression:"form.role"}},t._l(t.roles,(function(t,e){return a("el-option",{key:e,attrs:{label:t.key,value:t.id}})})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"头像","label-width":t.formLabelWidth,prop:"avatar"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.server,"show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload,headers:t.headers}},[t.form.avatar?a("img",{staticClass:"avatar",attrs:{src:t.form.avatar}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确 定")])],1)],1)],1)},r=[],n=(a("7f7f"),a("db72")),i=a("c24f"),l=a("cc5e"),s=a("61f7"),c=a("2f62"),u={data:function(){return{isEdit:!1,server:"https://cmsapi.doctormeeting.com/admin/user/uploadPhoto",headers:{"X-Token":""},dialogFormVisible:!1,formLabelWidth:"120px",tableData:[],form:{username:"",password:"",name:"",introduction:"",role:1,avatar:""},roles:[]}},computed:Object(n["a"])({},Object(c["b"])(["token"])),mounted:function(t){var e=this;e.form.username="",this.headers["X-Token"]=this.token,e.getUsers(),Object(l["c"])().then((function(t){e.roles=t.data}))},methods:{resetForm:function(){this.form={username:"",password:"",name:"",introduction:"",role:2,avatar:"https://wpimg.wallstcn.com/f778738c-e4f8-4870-b634-56703b4acafe.gif"}},getUsers:function(){var t=this;Object(i["g"])().then((function(e){t.tableData=e.data}))},newUser:function(){var t=this;t.isEdit=!1,this.dialogFormVisible=!0,this.$nextTick((function(){t.resetForm()}))},handleAvatarSuccess:function(t,e){console.log(t),this.form.avatar=t.data.url},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type,a=t.size/1024/1024<2;return e||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),e&&a},confirm:function(){var t=this,e=Object(s["c"])(t.form,["登录名","密码","姓名","介绍","角色","头像"],this);e&&(t.isEdit?Object(i["c"])(t.form).then((function(e){"ok"===e.status&&(t.dialogFormVisible=!1,t.resetForm(),t.getUsers()),t.$alert(e.data.msg,"提示",{confirmButtonText:"确定"})})):Object(i["a"])(t.form).then((function(e){"ok"===e.status&&(t.dialogFormVisible=!1,t.resetForm(),t.getUsers()),t.$alert(e.data.msg,"提示",{confirmButtonText:"确定"})})))},handleEdit:function(t,e){var a=this;a.dialogFormVisible=!0,a.isEdit=!0,a.form.username=e.username,a.form.password="",a.form.introduction=e.introduction,a.form.name=e.name,a.form.roles=e.roles,a.form.avatar=e.avatar,a.form.id=e.id},handleDelete:function(t,e){var a=this,o=this;this.$confirm("此操作将永久删除"+e.username+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(i["b"])({id:e.id}).then((function(t){"ok"===t.status&&(o.$alert(t.data.msg,"提示",{confirmButtonText:"确定"}),o.getUsers())}))})).catch((function(){a.$message({type:"info",message:"已取消删除"})}))}}},f=u,m=(a("12ae"),a("2877")),d=Object(m["a"])(f,o,r,!1,null,"1c3504f4",null);e["default"]=d.exports},7328:function(t,e,a){},cc5e:function(t,e,a){"use strict";a.d(e,"d",(function(){return r})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return i})),a.d(e,"e",(function(){return l})),a.d(e,"b",(function(){return s}));var o=a("b775");function r(t){return Object(o["a"])({url:"admin/routes/getRoutes",method:"post",data:t})}function n(){return Object(o["a"])({url:"admin/roles",method:"get"})}function i(t){return Object(o["a"])({url:"admin/role/create",method:"post",data:t})}function l(t,e){return Object(o["a"])({url:"admin/role/update",method:"post",data:e})}function s(t){return Object(o["a"])({url:"admin/role/delete",method:"post",data:{id:t}})}}}]);