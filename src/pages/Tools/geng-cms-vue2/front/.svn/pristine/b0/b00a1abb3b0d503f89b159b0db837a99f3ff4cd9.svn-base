(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-17592aca"],{"68f3":function(t,e,i){},7721:function(t,e,i){"use strict";var l=i("e251"),a=i.n(l);a.a},d61b:function(t,e,i){"use strict";var l=i("68f3"),a=i.n(l);a.a},da6c:function(t,e,i){"use strict";i.r(e);var l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"dragTable",staticStyle:{width:"100%"},attrs:{data:t.list,"row-key":"id",border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{align:"center",label:"ID",width:"65"},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.row;return[i("span",[t._v(t._s(l.id))])]}}])}),t._v(" "),i("el-table-column",{attrs:{width:"180",align:"center",label:"时间"},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.row;return[i("span",[t._v(t._s(t._f("parseTime")(l.create_date,"{y}-{m}-{d} {h}:{i}")))])]}}])}),t._v(" "),i("el-table-column",{attrs:{width:"200",label:"轮播图",align:"center"},scopedSlots:t._u([{key:"default",fn:function(t){var e=t.row;return[i("el-image",{staticStyle:{width:"180px"},attrs:{src:e.img_url,"preview-src-list":[e.img_url]}})]}}])}),t._v(" "),i("el-table-column",{attrs:{width:"180",label:"链接地址"},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.row;return[i("span",[t._v(t._s(l.jump_url))])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"排名权重",width:"95"},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.row;return[i("span",[t._v(t._s(l.ranking))])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"标题",width:"125"},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.row;return[i("span",[t._v(t._s(l.title))])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"是否隐藏",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.row;return[i("span",[t._v(t._s(l.display?"显示":"隐藏"))])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"拖动改变顺序",width:"80"},scopedSlots:t._u([{key:"default",fn:function(t){return[i("svg-icon",{staticClass:"drag-handler",attrs:{"icon-class":"drag"}})]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(i){return t.editbanner(e.$index)}}},[t._v("编辑")]),t._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"}},[t._v("删除")])]}}])})],1),t._v(" "),i("el-dialog",{attrs:{title:"编辑内容",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-form",{attrs:{model:t.form}},[i("el-form-item",{attrs:{label:"标题","label-width":t.formLabelWidth}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1)],1),t._v(" "),i("el-form",{attrs:{model:t.form}},[i("el-form-item",{attrs:{label:"链接地址","label-width":t.formLabelWidth}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.jump_url,callback:function(e){t.$set(t.form,"jump_url",e)},expression:"form.jump_url"}})],1)],1),t._v(" "),i("el-form",{attrs:{model:t.form}},[i("el-form-item",{attrs:{label:"是否隐藏","label-width":t.formLabelWidth}},[i("el-switch",{attrs:{"active-text":t.form.display?"显示":"隐藏","active-value":1,"inactive-value":0},model:{value:t.form.display,callback:function(e){t.$set(t.form,"display",e)},expression:"form.display"}})],1)],1),t._v(" "),i("el-form",{attrs:{model:t.form}},[i("el-form-item",{attrs:{label:"图片","label-width":t.formLabelWidth}},[i("el-upload",{ref:"my-upload",attrs:{action:t.server,"list-type":"picture-card","on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove,"on-success":t.handleSuccess,limit:1}},[i("i",{staticClass:"el-icon-plus"})])],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确 定")])],1)],1)],1)},a=[],n=(i("96cf"),i("3b8d")),r=i("b775");function o(){return Object(r["a"])({url:"admin/activity/getBanner",method:"get"})}function s(t){return Object(r["a"])({url:"admin/activity/updateOrder",method:"post",data:t})}function c(t){return Object(r["a"])({url:"admin/activity/updateBanner",method:"post",data:t})}var u=i("c46f"),d=i("53fe"),f=i.n(d),m=[],p={name:"DragTable",filters:{statusFilter:function(t){var e={published:"success",draft:"info",deleted:"danger"};return e[t]}},data:function(){return{server:"https://cmsapi.doctormeeting.com/admin/upload/uploadFile",dialogFormVisible:!1,formLabelWidth:"auto",list:[],form:{},total:0,listLoading:!0,listQuery:{page:1,limit:10},sortable:null,oldList:[],newList:[]}},mounted:function(){this.getList()},created:function(){},methods:{handleRemove:function(t,e){console.log(t,e)},handleSuccess:function(t,e,i){console.log(t),this.form.img_url=t.data.ossUrl},handlePictureCardPreview:function(t){},confirm:function(){var t=this,e=this;c(e.form).then((function(i){2e4===i.code&&(t.$message("更新成功"),e.dialogFormVisible=!1,e.getList(),e.$refs["my-upload"].clearFiles())}))},editbanner:function(t){var e=this;e.form="",e.dialogFormVisible=!0,e.form=e.list[t],console.log(e.form)},getList:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,i,l=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.listLoading=!0,t.next=3,o(this.listQuery);case 3:e=t.sent,i=e.data,this.list=u["a"].sortBy(i,(function(t){return-t.ranking})),m=JSON.parse(JSON.stringify(this.list)),this.listLoading=!1,this.oldList=this.list.map((function(t){return t.id})),this.newList=this.oldList.slice(),this.$nextTick((function(){l.setSort()}));case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),setSort:function(){var t=this,e=this.$refs.dragTable.$el.querySelectorAll(".el-table__body-wrapper > table > tbody")[0];this.sortable=f.a.create(e,{ghostClass:"sortable-ghost",setData:function(t){t.setData("Text","")},onEnd:function(e){var i=t.list.splice(e.oldIndex,1)[0];s({old:m[e.oldIndex],new:m[e.newIndex]}).then((function(l){t.getList(),t.list.splice(e.newIndex,0,i);var a=t.newList.splice(e.oldIndex,1)[0];t.newList.splice(e.newIndex,0,a)}))}})}}},v=p,b=(i("7721"),i("d61b"),i("2877")),h=Object(b["a"])(v,l,a,!1,null,"0e0a8061",null);e["default"]=h.exports},e251:function(t,e,i){}}]);